function KahnsAlgorithm(Graph):

    inDegree = array/map initialized to 0 for all vertices

    // 1. Compute in-degree of every vertex
    for each u in Graph:
        for each neighbor v of u:
            inDegree[v] = inDegree[v] + 1

    // 2. Enqueue all vertices with in-degree 0
    Queue = new Queue()
    for each vertex v in Graph:
        if inDegree[v] == 0:
            Queue.enqueue(v)

    topologicalOrder = []

    // 3. Process the queue
    while Queue is not empty:
        u = Queue.dequeue()
        topologicalOrder.append(u)

        for each neighbor v of u:
            inDegree[v] = inDegree[v] - 1
            if inDegree[v] == 0:
                Queue.enqueue(v)

    // 4. If not all vertices are processed â†’ cycle exists
    if length(topologicalOrder) != NumberOfVertices:
        return Error("Graph has a cycle")

    return topologicalOrder
