function MergeSort(arr):
    if length(arr) <= 1:
        return arr

    mid = length(arr) / 2

    left  = MergeSort(arr[0 ... mid-1])
    right = MergeSort(arr[mid ... end])

    return Merge(left, right)



function Merge(left, right):
    result = []
    i = 0
    j = 0

    while i < length(left) and j < length(right):
        if left[i] <= right[j]:
            append left[i] to result
            i = i + 1
        else:
            append right[j] to result
            j = j + 1

    // Add remaining elements
    append all remaining elements of left to result
    append all remaining elements of right to result

    return result
