function AVLInsert(node, key):
    
    // 1. Standard BST Insert
    if node is NULL:
        return new Node(key)
    
    if key < node.key:
        node.left = AVLInsert(node.left, key)
    else if key > node.key:
        node.right = AVLInsert(node.right, key)
    else:
        return node // No duplicates allowed
        
    
    // 2. Update height of this ancestor node
    node.height = 1 + max(Height(node.left), Height(node.right))
    
    
    // 3. Get Balance Factor
    balance = GetBalance(node)
    
    
    // 4. Check for imbalance and Rotate
    
    
    // Left Left Case
    if balance > 1 and key < node.left.key:
        return RightRotate(node)
        
    
    // Right Right Case
    if balance < -1 and key > node.right.key:
        return LeftRotate(node)
        
    
    // Left Right Case
    if balance > 1 and key > node.left.key:
        node.left = LeftRotate(node.left)
        return RightRotate(node)
        
    
    // Right Left Case
    if balance < -1 and key < node.right.key:
        node.right = RightRotate(node.right)
        return LeftRotate(node)
        
    return node

function RightRotate(y):
    x = y.left
    T2 = x.right
    
    // Perform rotation
    x.right = y
    y.left = T2
    
    // Update heights
    y.height = max(Height(y.left), Height(y.right)) + 1
    x.height = max(Height(x.left), Height(x.right)) + 1
    return x

function LeftRotate(x):
    y = x.right
    T2 = y.left
    
    // Perform rotation
    y.left = x
    x.right = T2
    
    // Update heights
    x.height = max(Height(x.left), Height(x.right)) + 1
    y.height = max(Height(y.left), Height(y.right)) + 1
    return y
    .